# 管理会话（Sessions）

> 学习 Claude Code 会话如何工作，以及如何跨多个对话管理对话历史。

## 为什么这很重要

想象你在处理一个项目，并与 Claude Code 进行讨论。你分享上下文 — 文件路径、要求、你的偏好。Claude 理解一切。

然后你关闭 Claude Code 回到明天。你问 Claude 相同的问题……它什么都不知道。

这不是 bug — 这就是会话的工作方式。每次你启动 Claude Code，你都会获得一个全新的对话。这很好用来组织事情，但如果你想继续一个之前的对话或审查你之前讨论过的内容呢？

这就是会话管理的作用。Claude Code 让你能够：
- **恢复**一个之前的会话（继续你离开的地方）
- **浏览**过去的会话（找到并重播旧对话）
- **保持组织**的对话历史

## 什么是会话？

一个**会话**是与 Claude Code 的一次单独对话。它是你说的所有内容和 Claude 响应的完整记录。

把它想象成笔记本：
- 每次你启动 Claude Code，你打开一个**新笔记本**
- 该对话中的所有内容都进入那个笔记本
- 当你退出时，笔记本被保存
- 下次你启动 Claude Code 时，你会获得一个**空白笔记本**（新会话）

这种分离是有用的，因为：
1. **组织** — 每个项目/任务可以有自己的会话
2. **隐私** — 会话彼此隔离
3. **历史** — 你可以随时返回任何过去的会话

## 理解会话持久性

默认情况下，Claude Code 的工作方式如下：

**会话 1：**
```
                        我跟你说：我最喜欢的食物是披萨
了解。

                        我的最喜欢的食物是什么？
你最喜欢的食物是披萨。
（退出 Claude Code - 会话已保存）
```

**会话 2：**（新会话，全新开始）
```
                        我的最喜欢的食物是什么？
我不知道你最喜欢的食物是什么。我们还没有讨论过。
```

Claude 在会话 2 期间对会话 1 没有记忆。这是有意的 — 每个会话都是独立的。但 Claude Code 保存每个会话。你可以使用会话命令稍后访问它们。

## 会话命令

Claude Code 提供两个命令来管理会话：

### `-c` (Continue) — 继续上一个会话

```bash
claude -c
```

这会**继续**你最后所在的会话。来自你之前对话的所有上下文都会回来。这就像打开你之前拥有的相同笔记本。

### `-r` (Resume) — 从会话历史恢复

```bash
claude -r
```

这显示你所有过去会话的列表。你可以选择想要恢复的那个。这就像浏览你的笔记本集合并挑选你想打开的那个。

## 动手练习 1：理解会话隔离

让我们通过体验隔离来学习会话如何工作。

**部分 A：在会话中创建上下文**

1. 正常启动 Claude Code：`claude`
2. 告诉 Claude 你的偏好：`Let me tell you: my favorite food is cheese burger`
3. 验证 Claude 是否记得：问 `What's my favorite food?`
4. Claude 应该回答："Your favorite food is cheese burger"

**部分 B：退出并重新开始**

5. 退出 Claude Code（Ctrl+C 两次）
6. 正常重新启动 Claude Code：`claude`
7. 问相同的问题：`What's my favorite food?`
8. Claude 回应："I don't know what your favorite food is"

**发生了什么？**

你创建了两个独立的会话。会话 1 有你的食物偏好。会话 2 从头开始，没有上下文。信息没有丢失 — 它被存储了 — 但会话 2 看不到它，因为它们是分开的对话。

这就是为什么管理会话很重要。没有工具来恢复或审查，你会丢失重要的上下文。

## 动手练习 2：使用 `-c` 恢复

现在让我们使用 `-c` 标志来继续一个之前的会话。

**部分 A：创建一个有上下文的新会话**

1. 启动 Claude Code：`claude`
2. 告诉 Claude 一些事情：`Let me tell you my favorite programming language is Python`
3. 退出 Claude Code

**部分 B：使用 -c 恢复会话**

4. 运行：`claude -c`
5. Claude Code 应该显示："Resuming session..."或类似的东西
6. 问一个问题：`What programming language do I like?`
7. Claude 回应："Your favorite programming language is Python"（记得了！）

**发生了什么？**

`-c` 标志恢复了你的最后一个会话。来自该对话的所有上下文都回来了。这就像重新打开同一个笔记本而不是获得一个新的。

## 动手练习 3：使用 `-r` 浏览会话

现在让我们使用 `-r` 标志从多个过去的会话中选择。

**设置（如果你还没有做练习 1 和 2）：**
- 确保你至少有 2 个有不同上下文的过去会话
- 练习 1 有一个关于食物的会话
- 练习 2 有一个关于编程语言的会话

**实践：**

1. 退出 Claude Code（如果你在一个中）
2. 运行：`claude -r`
3. 你会看到过去会话的列表（带有时间戳或摘要）
4. 选择你早期的一个会话（例如，关于食物或编程的那个）
5. 你现在在该会话中 — 所有上下文都恢复了
6. 问：`What did we discuss?`或引用你分享的信息
7. Claude 记得来自该特定会话的上下文

**发生了什么？**

`-r` 标志让你浏览整个会话历史，并选择想要恢复的那个。当你有许多对话并想继续一个特定的对话而不仅仅是最新的对话时，这非常强大。

## 快速参考

- **新会话：** `claude`（默认行为）
- **继续最后一个会话：** `claude -c`
- **浏览并选择一个会话：** `claude -r`
- **会话存储：** 会话会自动保存；你不需要做任何事情
- **上下文隔离：** 每个会话从头开始，除非你恢复
- **`-c` 的替代：** `/clear` 清除当前会话的上下文，但不会创建新的会话文件

## 常见场景

**场景 1：你在处理一个项目，想明天回到它**

使用 `claude -c` 恢复你离开的地方。你的所有上下文都在那里。

**场景 2：你进行了许多对话，不记得哪一个有重要信息**

使用 `claude -r` 浏览会话并找到你需要的那个。

**场景 3：你想完全从头开始，没有之前的上下文，但保持旧的会话保存**

只需正常启动 Claude Code 用 `claude`。一个新会话被创建，你的旧会话被保留以供以后使用。

## 导师的话：组织你的想法

在我职业生涯的早期，我会丢失重要对话。"等等，我在哪个会话中讨论过架构？"或"我们同意的要求是什么？"

我学到会话管理就像对话的项目管理。每个专注的对话都有自己的会话。当你回到它时，一切都在那里。

真正的技能是知道何时启动新会话。这是我的模式：
- **为每个项目/任务启动新会话** — 不同的目标值得不同的笔记本
- **不要在任务中途切换会话** — 在启动新会话之前完成你的当前会话
- **当卡住时审查旧会话** — 看看你如何解决类似的问题

随着时间推移，你的会话历史变成一个个人知识库。你可以追踪你的想法、看看你如何接近问题，甚至从错误中学到东西。

## 进一步阅读

- [Claude Code 文档](https://code.claude.com/docs)
- [工作流最佳实践](https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering)
